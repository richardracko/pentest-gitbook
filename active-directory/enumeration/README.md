---
description: Active Directory Enumeration
---

# II - Enumeration

Dot source [PowerView](https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1) at first:

```bash
. .\PowerView.ps1
```

## Domain

Get Current Domain

```bash
Get-NetDomain
Get-NetDomain -Domain pentest.local
```

Get Domain SID

```bash
Get-DomainSID
Get-DomainSID -Domain pentest.local
```

Domain Policy

```bash
Get-DomainPolicy
```

Domain Controller

```bash
Get-NetDomainController
Get-NetDomainController -Domain pentest.local
```

## Forest

Get Details about Forest.

```bash
Get-NetForest
Get-NetForest -Forest forest.local
```

Get all Domains in Forest

```bash
Get-NetForestDomain
Get-NetForestDomain -Forest forest.local
```

Get Domain trust

```bash
Get-NetDomainTrust
Get-NetDomainTrust -Domain external.pentest.local
```

## Computers

List of all Computers in Domain

```bash
Get-NetComputer
Get-NetComputer -Domain pentest.local
```

List of all Computers with details

```bash
Get-NetComputer -FullData
```

## Users

List of all Users with details

```bash
 Get-NetUser
 Get-NetUser -Domain pentest.local
```

Filter user list

```bash
Get-NetUser | ?{$_.cn -match "hacker"}
```

### Search in Description field

```text
Find-UserField -SearchField Description -SearchTerm "pass"
Find-UserField -SearchField Description -SearchTerm "admin"
Find-UserField -SearchField Description -SearchTerm "manage"
...
```

## Groups

Get list of all Groups

```bash
Get-NetGroup
Get-NetGroup -Domain pentest.local
```

Get Full data of filter specific Group

```bash
Get-NetGroup -FullData | ?{$_.cn -match "RDP Users"}
```

Get all Group members:

```bash
Get-NetGroupMember -GroupName "Domain Admins" -Recurse
```

Get current User Group membership

```bash
Get-NetGroup -UserName "hacker"
```

List all the local groups on a machine \(needs administrator privs on non-dc machines\)

```text
Get-NetLocalGroup -ComputerName DC01.pentest.local -ListGroups
```

Get members of all the local groups on a machine \(needs administrator privs on non-dc machines\)

```text
Get-NetLocalGroup -ComputerName DC01.pentest.local -Recurse
```

## OU - Organization Units

> An organizational unit \(OU\) is a subdivision within an Active Directory into which you can place users, groups, computers, and other organizational units. You can create organizational units to mirror your organization's functional or business structure.

Get all OUs in current domain

```text
Get-NetOU
```

Get Details about specific OU:

```text
Get-NetOU -OUName 'StudentMachines' -FullData
```

## GPO - Group Policy Object

> Group Policy provides centralized management and configuration of operating systems, applications, and users' settings in an Active Directory environment. 
>
> A **Group** **Policy** **Object** \(GPO\) is a virtual collection of **policy** settings. It is a component of Group Policy that can be used as a resource in Microsoft systems to control user accounts and user activity.

List all GPOs

```text
Get-NetGPO
```

Get GPOs applied on specific OU

```text
Get-NetOU 'StudentMachines' -FullData | select gplink
```

## ACL - Access Control List

> An access-control list \(ACL\), with respect to a computer file system, is a list of permissions associated with an object.

ACL for specific group:

```text
Get-ObjectAcl 'Domain Admins' -ResolveGUIDs
```

Search for interesting ACEs

```text
Invoke-ACLScanner -ResolveGUIDs
Invoke-ACLScanner -ResolveGUIDs | ?{$_.IdentityReference -match "target"}
Invoke-ACLScanner -ResolveGUIDs | ?{$_.IdentityReference -match "targetgroup"}
```

## Shares

Find shares in current domain

```text
Invoke-ShareFinder -verbose -ExcludeStandard -ExcludePrint -ExcludeIPC
```

Find sensitive files

```text
Invoke-FileFinder -Verbose
```

