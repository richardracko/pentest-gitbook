---
description: Executing PowerShell commands with another users credentials
---

# PowerShell RunAs

## Command Line

Impersonate user from command line:

```text
runas /netonly /user:domain\user powershell.exe
```

## PowerShell

**Script:**

```text
$username = 'john'
$securePassword = ConvertTo-SecureString ‘Password123!' -AsPlainText -Force
$credential = New-Object System.Management.Automation.PSCredential $username, $securePassword
Start-Process powershell -Credential $credential
```

**One-liner:**

```text
Start-Process powershell -Credential $(New-Object System.Management.Automation.PSCredential 'john', $(ConvertTo-SecureString ‘Password123!' -AsPlainText -Force)) -WorkingDirectory C:\
```

{% hint style="info" %}
Always specify WorkingDirectory because you may encounter permissions problem 
{% endhint %}

### PowerView

```text
Invoke-UserImpersonation -Credential <PSCredential>
```

